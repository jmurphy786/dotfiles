unbind r
unbind C-b
unbind C-a
# Reload config with Prefix+r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

set -g renumber-windows on
set -g prefix M-F9
bind M-F9 send-prefix
set -g mouse on
set -g mode-keys vi

#set-option -g allow-rename off
#set-window-option -g automatic-rename off
#set-option -g set-titles off
# Claude AI - Append to current nvim file (auto-detect)
bind-key C-c display-popup -E -w 90% -h 90% "$HOME/.local/bin/tmux-claude-append"


# Claude AI - New conversation
bind-key C-n run-shell "tmux display-popup -E -w 90% -h 90% 'claude-new'"

unbind '"'
unbind %
bind v split-window -v -c "#{pane_current_path}"  # horizontal split
bind s  split-window -h -c "#{pane_current_path}"  # vertical split


bind-key n display-menu -T "Notes" \
    "Personal" p "new-window -n 'notes-personal' -c ~/notes 'nvim index.md'" \
    "Work" w "new-window -n 'notes-work' -c ~/notes-work 'nvim index.md'"

bind q kill-window
bind x kill-pane

set -g base-index 1
setw -g pane-base-index 1

set -g repeat-time 1000  # 1 second to keep pressing

# ~/.tmux.conf
set -g default-terminal "tmux-256color"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'
set -sa terminal-features ',xterm-256color:RGB'

# Force proper window sizing
setw -g aggressive-resize on

# Fix rendering issues
set -g focus-events on

bind-key j command-prompt -p "join pane from:" "join-pane -s '%%'"
bind-key b break-pane

set-option -g status-position top
# Swap current pane with pane in that direction
bind-key C-h swap-pane -U
bind-key C-j swap-pane -D  
bind-key C-k swap-pane -U
bind-key C-l swap-pane -D

bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5
bind 6 select-window -t 6
bind 7 select-window -t 7
bind 8 select-window -t 8
bind 9 select-window -t 9

# Capital letters for resizing in specific directions
bind -r H resize-pane -L 5   # Resize left
bind -r J resize-pane -D 5   # Resize down
bind -r K resize-pane -U 5   # Resize up
bind -r L resize-pane -R 5   # Resize right

# Bright border on active pane
# set -g pane-border-style fg=colour238
# set -g pane-active-border-style "bg=default fg=colour208"

# set -g default-terminal "tmux-256color"
# set -ga terminal-overrides ",*256col*:Tc"

# Dim inactive panes significantly

# Or for more dramatic difference:
#set -g window-style 'fg=colour247,bg=colour234'        # Very dim inactive
#set -g window-active-style 'fg=colour255,bg=default'   # Bright active

# Dim inactive panes slightly
#set -g window-style 'fg=colour247,bg=colour236'
#set -g window-active-style 'fg=colour250,bg=black'

set -g pane-border-style 'fg=colour238'
set -g pane-active-border-style 'fg=colour208'  # Bright border for active
set -g window-style 'fg=colour250,bg=default'
set -g window-active-style 'fg=colour255,bg=default'

set -g pane-border-lines heavy

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-save-command-strategy 'pane'

# Resurrect restores dotnet
set -g @resurrect-processes 'ssh ~dotnet lazygit "npm run*" docker-compose tail python node'

bind Right switch-client -n  # Prefix + Right Arrow
bind Left switch-client -p   # Prefix + Left Arrow

# Auto-enable logging when any pane changes
set-hook -g after-select-pane 'run-shell "~/.tmux/auto-log-dotnet.sh"'
set-hook -g pane-focus-in 'run-shell "~/.tmux/auto-log-dotnet.sh"'

# Custom status bar that shows window names
set -g status-style bg=colour235,fg=colour136
set -g status-left '#[fg=colour235,bg=colour136,bold] #S '
set -g status-right '#[fg=colour235,bg=colour136,bold] %H:%M '
set -g status-left-length 20
set -g status-right-length 50

# Window status - THIS IS THE KEY PART
set -g window-status-format '#[fg=colour244,bg=colour235] #I:#W '
set -g window-status-current-format '#[fg=colour235,bg=colour136,bold] #I:#W '
run '~/.tmux/plugins/tpm/tpm'

set-hook -g client-session-changed 'clear-history'
bind-key -r f display-popup -E -w 80% -h 80% "~/.local/bin/tmux-sessionizer"
bind-key k display-popup -E -w 80% -h 80% "~/.local/bin/tmux-kill-session"
bind-key -r M-h run-shell "tmux neww tmux-sessionizer -s 0"
bind-key -r M-t run-shell "tmux neww tmux-sessionizer -s 1"
bind-key -r M-n run-shell "tmux neww tmux-sessionizer -s 2"
bind-key -r M-s run-shell "tmux neww tmux-sessionizer -s 3"

